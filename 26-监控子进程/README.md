### 第26章 监控子进程

##### 等待子进程

当一个进程正常或异常终止时，内核就向父进程发送SIGCHLD信号，系统的默认动作时忽略它，如果调用wait或waitpid则：

- 如果其所有子进程都在运行，则阻塞
- 如果一个子进程已经终止，正等待父进程获取其终止状态，则取得该子进程的终止状态立即返回
- 如果没有任何子进程，则出错返回-1并将errno置为ECHILD

```
#include <sys/wait.h>

pid_t wait(int *status); 
// 返回值，若成功，返回进程ID，若出错，返回0或-1

如下代码可等待所有子进程退出：
while ((child_pid = wait(NULL)) != -1)
    continue;
if (errno != ECHILD)
    perror("wait error");
另一种退出循环的方法是记录终止子进程的数量当与创建子进程数量相同时，退出循环
如果同一时间多个子进程退出，其顺序取决于具体实现，Linux各个版本也不尽相同
```



