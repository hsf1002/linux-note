### 第6章 进程

##### 进程号和父进程号

```
#include unistd.h>

pid_t getpid(void);
// 返回值：总是成功返回进程号
```

Linux内核限制进程号需小于等于32767（由PID_MAX定义，可通过/proc/sys/kernel/pid_max文件进行调整），新进程创建时，内核会按顺序将下一个可用的进程号分配给其使用，每当进程号达到32767时，内核将重置进程号计数器（重置为300，而不是1，小于此值得进程号为系统进程或守护进程长期占有），以便从最小整数开始分配

```
#include unistd.h>

pid_t getppid(void);
// 返回值：总是成功返回父进程号
```

每个进程都有父进程，以此类推，直到回溯到1号进程-init进程，即所有进程的始祖，如果子进程的父进程终止，子进程就会变成“孤儿”，init进程随即收养该进程，变成其父进程

##### 进程内存布局

图中的读写段包括：初始化数据段和非初始化数据段

![img](https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1572747969338&di=7eaececaf570a17a0a975a7a1b6e3493&imgtype=0&src=http%3A%2F%2Fhiphotos.baidu.com%2Flongzuo%2Fpic%2Fitem%2Fc7674ea7d933c8951320f8c8d11373f0830200ee.jpg)

* 文本段包含了进程运行的程序机器语言指令
* 初始化数据段包含显式初始化的全局变量和静态变量
* 未初始化数据段包含未进行显式初始化的全局变量和静态变量
* 栈是动态增减的段，由栈帧组成，栈帧中保存着函数的局部变量、实参和返回值
* 堆是可在运行时进行内存分配的一块区域，顶端称为program break

size命令可以显示二进制可执行文件的文本段、初始化数据段、非初始化数据段的大小

3个全局符号etext、edata和end分别表示文本段、初始化数据段和非初始化数据段结尾处下一个字节的地址

